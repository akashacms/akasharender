import path from 'node:path';
import { promises as fsp } from 'node:fs';
import Joi from "joi";
;
const joiIsPathsReturnType = Joi.object({
    vpath: Joi.string(),
    mime: Joi.string().optional().allow(null),
    mounted: Joi.string(),
    mountPoint: Joi.string(),
    pathInMounted: Joi.string(),
    mtimeMs: Joi.number(), // .integer(),
    info: Joi.any(),
    fspath: Joi.string(),
    renderPath: Joi.string()
});
export function validatePathsReturnType(obj) {
    return joiIsPathsReturnType.validate(obj);
}
;
export const joiAsset = Joi.object({
    vpath: Joi.string(),
    renderPath: Joi.string(),
    mime: Joi.string().optional().allow(null),
    mounted: Joi.string(),
    mountPoint: Joi.string(),
    pathInMounted: Joi.string(),
    fspath: Joi.string(),
    dirname: Joi.string(),
    mtimeMs: Joi.number(), // .integer(),
    info: Joi.any()
});
export function validateAsset(obj) {
    return joiAsset.validate(obj);
}
export const createAssetsTable = await fsp.readFile(path.join(import.meta.dirname, 'sql', 'create-table-assets.sql'), 'utf-8');
// This function and its siblings exist to avoid
// potential for conflict in initializing the
// variable holding the SQL and invoking
// the SQL to create the table.  By placing both
// in the same source file we ensure no conflict.
export async function doCreateAssetsTable(db) {
    await db.run(await createAssetsTable);
}
;
export const joiPartial = Joi.object({
    vpath: Joi.string(),
    renderPath: Joi.string(),
    mime: Joi.string().optional().allow(null),
    mounted: Joi.string(),
    mountPoint: Joi.string(),
    pathInMounted: Joi.string(),
    fspath: Joi.string(),
    dirname: Joi.string(),
    mtimeMs: Joi.number(), // .integer(),
    info: Joi.any(),
    // Added fields
    docBody: Joi.string().optional().allow(null),
    rendererName: Joi.string().optional().allow(null)
});
export function validatePartial(obj) {
    return joiPartial.validate(obj);
}
export const createPartialsTable = await fsp.readFile(path.join(import.meta.dirname, 'sql', 'create-table-partials.sql'), 'utf-8');
export async function doCreatePartialsTable(db) {
    await db.run(await createPartialsTable);
}
;
export const joiLayout = Joi.object({
    vpath: Joi.string(),
    renderPath: Joi.string(),
    mime: Joi.string().optional().allow(null),
    mounted: Joi.string(),
    mountPoint: Joi.string(),
    pathInMounted: Joi.string(),
    fspath: Joi.string(),
    dirname: Joi.string(),
    mtimeMs: Joi.number(), // .integer(),
    info: Joi.any(),
    // Added fields
    rendersToHTML: Joi.alternatives()
        .try(Joi.boolean(), Joi.number().integer().min(0).max(1)),
    docBody: Joi.string().optional().allow(null),
    rendererName: Joi.string().min(0).optional().allow(null)
});
export function validateLayout(obj) {
    return joiLayout.validate(obj);
}
export const createLayoutsTable = await fsp.readFile(path.join(import.meta.dirname, 'sql', 'create-table-layouts.sql'), 'utf-8');
export async function doCreateLayoutsTable(db) {
    await db.run(await createLayoutsTable);
}
;
export const joiDocument = Joi.object({
    vpath: Joi.string(),
    mime: Joi.string().optional().allow(null),
    mounted: Joi.string(),
    mountPoint: Joi.string(),
    pathInMounted: Joi.string(),
    fspath: Joi.string(),
    dirname: Joi.string(),
    mtimeMs: Joi.number(), // .integer(),
    info: Joi.any(),
    // Added fields
    renderPath: Joi.string(),
    rendersToHTML: Joi.alternatives()
        .try(Joi.boolean(), Joi.number().integer().min(0).max(1)),
    parentDir: Joi.string(),
    publicationTime: Joi.number().optional().allow(null),
    baseMetadata: Joi.any(),
    docMetadata: Joi.any(),
    docContent: Joi.string().min(0).optional().allow(null),
    docBody: Joi.string().min(0).optional().allow(null),
    metadata: Joi.any(),
    tags: Joi.any(),
    layout: Joi.alternatives()
        .try(Joi.string(), Joi.allow(null)),
    blogtag: Joi.alternatives()
        .try(Joi.string(), Joi.allow(null)),
    rendererName: Joi.string().min(0).optional().allow(null)
});
export function validateDocument(obj) {
    return joiDocument.validate(obj);
}
export const createDocumentsTable = await fsp.readFile(path.join(import.meta.dirname, 'sql', 'create-table-documents.sql'), 'utf-8');
export async function doCreateDocumentsTable(db) {
    await db.run(await createDocumentsTable);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NoZW1hLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vbGliL2NhY2hlL3NjaGVtYS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLElBQUksTUFBTSxXQUFXLENBQUM7QUFDN0IsT0FBTyxFQUFFLFFBQVEsSUFBSSxHQUFHLEVBQUUsTUFBTSxTQUFTLENBQUM7QUFDMUMsT0FBTyxHQUFHLE1BQU0sS0FBSyxDQUFDO0FBMERyQixDQUFDO0FBc0JGLE1BQU0sb0JBQW9CLEdBQUcsR0FBRyxDQUFDLE1BQU0sQ0FBQztJQUNwQyxLQUFLLEVBQUUsR0FBRyxDQUFDLE1BQU0sRUFBRTtJQUNuQixJQUFJLEVBQUUsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDLFFBQVEsRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUM7SUFDekMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxNQUFNLEVBQUU7SUFDckIsVUFBVSxFQUFFLEdBQUcsQ0FBQyxNQUFNLEVBQUU7SUFDeEIsYUFBYSxFQUFFLEdBQUcsQ0FBQyxNQUFNLEVBQUU7SUFDM0IsT0FBTyxFQUFFLEdBQUcsQ0FBQyxNQUFNLEVBQUUsRUFBRSxjQUFjO0lBQ3JDLElBQUksRUFBRSxHQUFHLENBQUMsR0FBRyxFQUFFO0lBQ2YsTUFBTSxFQUFFLEdBQUcsQ0FBQyxNQUFNLEVBQUU7SUFDcEIsVUFBVSxFQUFFLEdBQUcsQ0FBQyxNQUFNLEVBQUU7Q0FDM0IsQ0FBQyxDQUFDO0FBRUgsTUFBTSxVQUFVLHVCQUF1QixDQUFDLEdBQVE7SUFJNUMsT0FBTyxvQkFBb0IsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDOUMsQ0FBQztBQU1BLENBQUM7QUFTRixNQUFNLENBQUMsTUFBTSxRQUFRLEdBQUcsR0FBRyxDQUFDLE1BQU0sQ0FBQztJQUMvQixLQUFLLEVBQUUsR0FBRyxDQUFDLE1BQU0sRUFBRTtJQUNuQixVQUFVLEVBQUUsR0FBRyxDQUFDLE1BQU0sRUFBRTtJQUN4QixJQUFJ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QUFHLE1BQU0sR0FBRyxDQUFDLFFBQVEsQ0FDOUMsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFDekIsS0FBSyxFQUFFLDRCQUE0QixDQUFDLEVBQ3hDLE9BQU8sQ0FDZCxDQUFDO0FBRUYsTUFBTSxDQUFDLEtBQUssVUFBVSxzQkFBc0IsQ0FDeEMsRUFBaUI7SUFFakIsTUFBTSxFQUFFLENBQUMsR0FBRyxDQUFDLE1BQU0sb0JBQW9CLENBQUMsQ0FBQztBQUM3QyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiXG5pbXBvcnQgcGF0aCBmcm9tICdub2RlOnBhdGgnO1xuaW1wb3J0IHsgcHJvbWlzZXMgYXMgZnNwIH0gZnJvbSAnbm9kZTpmcyc7XG5pbXBvcnQgSm9pIGZyb20gXCJqb2lcIjtcbmltcG9ydCB7IEFzeW5jRGF0YWJhc2UgfSBmcm9tICdwcm9taXNlZC1zcWxpdGUzJztcblxuLyoqXG4gKiBFdmVyeSBjYWNoZSBlbnRyeSBoYXMgdGhlc2UgZmllbGRzLiAgRm9yXG4gKiBtb3N0IGNhY2hlIHR5cGVzLCB0aGVyZSB3aWxsIGJlIGFkZGl0aW9uYWxcbiAqIGZpZWxkcy5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBCYXNlQ2FjaGVFbnRyeSB7XG5cbiAgICAvKipcbiAgICAgKiBWaXJ0dWFsIHBhdGhcbiAgICAgKi9cbiAgICB2cGF0aDogc3RyaW5nO1xuXG4gICAgLyoqXG4gICAgICogTUlNRSB0eXBlXG4gICAgICovXG4gICAgbWltZT86IHN0cmluZztcblxuICAgIC8qKlxuICAgICAqIFRoZSBmaWxlLXN5c3RlbSBwYXRoIHdoaWNoIGlzIG1vdW50ZWRcbiAgICAgKiBpbnRvIHRoZSB2aXJ0dWFsIGZpbGUgc3BhY2UuXG4gICAgICovXG4gICAgbW91bnRlZDogc3RyaW5nO1xuXG4gICAgLyoqXG4gICAgICogVGhlIHZpcnR1YWwgZGlyZWN0b3J5IG9mIHRoZSBtb3VudFxuICAgICAqIGVudHJ5IGluIHRoZSBkaXJlY3Rvcnkgc3RhY2suXG4gICAgICovXG4gICAgbW91bnRQb2ludDogc3RyaW5nO1xuXG4gICAgLyoqXG4gICAgICogVGhlIHJlbGF0aXZlIHBhdGggdW5kZXJuZWF0aCB0aGUgbW91bnRQb2ludC5cbiAgICAgKi9cbiAgICBwYXRoSW5Nb3VudGVkOiBzdHJpbmc7XG5cbiAgICAvKipcbiAgICAgKiBBYnNvbHV0ZSBwYXRoIG5hbWUgaW4gdGhlIHBoeXNpY2FsXG4gICAgICogZmlsZXN5c3RlbS5cbiAgICAgKi9cbiAgICBmc3BhdGg6IHN0cmluZztcblxuICAgIC8qKlxuICAgICAqIGRpcm5hbWUgZm9yIGZzcGF0aFxuICAgICAqL1xuICAgIGRpcm5hbWU6IHN0cmluZztcblxuICAgIC8qKlxuICAgICAqIFRoZSBtb2RpZmljYXRpb24gdGltZSwgaW4gbWlsaXNlY29uZHMuXG4gICAgICovXG4gICAgbXRpbWVNczogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogSW5mbyBvYmplY3QgcHJvdmlkZWQgYnkgU3RhY2tlZERpcnMgYW5kXG4gICAgICogYW5ub3RhdGVkIHdpdGggZ2F0aGVySW5mb0RhdGFcbiAgICAgKi9cbiAgICBpbmZvOiBhbnk7XG59O1xuXG4vKipcbiAqIFR5cGUgZm9yIHJldHVybiBmcm9tIHBhdGhzIG1ldGhvZC4gIFRoZSBmaWVsZHMgaGVyZVxuICogYXJlIHdoYXRzIGluIHRoZSBBc3NldC9MYXlvdXQvUGFydGlhbCBjbGFzc2VzIGFib3ZlXG4gKiBwbHVzIGEgY291cGxlIGZpZWxkcyB0aGF0IG9sZGVyIGNvZGUgZXhwZWN0ZWRcbiAqIGZyb20gdGhlIHBhdGhzIG1ldGhvZC5cbiAqL1xuZXhwb3J0IHR5cGUgUGF0aHNSZXR1cm5UeXBlID0ge1xuICAgIHZwYXRoOiBzdHJpbmcsXG4gICAgbWltZT86IHN0cmluZyxcbiAgICBtb3VudGVkOiBzdHJpbmcsXG4gICAgbW91bnRQb2ludDogc3RyaW5nLFxuICAgIHBhdGhJbk1vdW50ZWQ6IHN0cmluZyxcbiAgICBtdGltZU1zOiBudW1iZXIsXG4gICAgaW5mbzogYW55LFxuICAgIC8vIFRoZXNlIHdpbGwgYmUgY29tcHV0ZWQgaW4gQmFzZUZpbGVDYWNoZVxuICAgIC8vIFRoZXkgd2VyZSByZXR1cm5lZCBpbiBwcmV2aW91cyB2ZXJzaW9ucy5cbiAgICBmc3BhdGg6IHN0cmluZyxcbiAgICByZW5kZXJQYXRoOiBzdHJpbmdcbn07XG5cbmNvbnN0IGpvaUlzUGF0aHNSZXR1cm5UeXBlID0gSm9pLm9iamVjdCh7XG4gICAgdnBhdGg6IEpvaS5zdHJpbmcoKSxcbiAgICBtaW1lOiBKb2kuc3RyaW5nKCkub3B0aW9uYWwoKS5hbGxvdyhudWxsKSxcbiAgICBtb3VudGVkOiBKb2kuc3RyaW5nKCksXG4gICAgbW91bnRQb2ludDogSm9pLnN0cmluZygpLFxuICAgIHBhdGhJbk1vdW50ZWQ6IEpvaS5zdHJpbmcoKSxcbiAgICBtdGltZU1zOiBKb2kubnVtYmVyKCksIC8vIC5pbnRlZ2VyKCksXG4gICAgaW5mbzogSm9pLmFueSgpLFxuICAgIGZzcGF0aDogSm9pLnN0cmluZygpLFxuICAgIHJlbmRlclBhdGg6IEpvaS5zdHJpbmcoKVxufSk7XG5cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVBhdGhzUmV0dXJuVHlwZShvYmo6IGFueSk6IHtcbiAgICBlcnJvcjogYW55LFxuICAgIHZhbHVlOiBQYXRoc1JldHVyblR5cGVcbn0ge1xuICAgIHJldHVybiBqb2lJc1BhdGhzUmV0dXJuVHlwZS52YWxpZGF0ZShvYmopO1xufVxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLyBBc3NldFxuXG5leHBvcnQgaW50ZXJmYWNlIEFzc2V0RmllbGRzIHtcblxufTtcblxuLyoqXG4gKiBEZXNjcmliZXMgYW4gZW50cnkgaW4gYW4gQXNzZXQgZGlyZWN0b3J5LCBtZWFuaW5nXG4gKiB0aGUgZmlsZXMgd2hpY2ggYXJlIHNpbXBseSBjb3BpZWQgdG8gdGhlIG91dHB1dFxuICogZGlyZWN0b3J5IHdpdGggbm8gcmVuZGVyaW5nIHByb2Nlc3MuXG4gKi9cbmV4cG9ydCB0eXBlIEFzc2V0ID0gQmFzZUNhY2hlRW50cnkgJiBBc3NldEZpZWxkcztcblxuZXhwb3J0IGNvbnN0IGpvaUFzc2V0ID0gSm9pLm9iamVjdCh7XG4gICAgdnBhdGg6IEpvaS5zdHJpbmcoKSxcbiAgICByZW5kZXJQYXRoOiBKb2kuc3RyaW5nKCksXG4gICAgbWltZTogSm9pLnN0cmluZygpLm9wdGlvbmFsKCkuYWxsb3cobnVsbCksXG4gICAgbW91bnRlZDogSm9pLnN0cmluZygpLFxuICAgIG1vdW50UG9pbnQ6IEpvaS5zdHJpbmcoKSxcbiAgICBwYXRoSW5Nb3VudGVkOiBKb2kuc3RyaW5nKCksXG4gICAgZnNwYXRoOiBKb2kuc3RyaW5nKCksXG4gICAgZGlybmFtZTogSm9pLnN0cmluZygpLFxuICAgIG10aW1lTXM6IEpvaS5udW1iZXIoKSwgLy8gLmludGVnZXIoKSxcbiAgICBpbmZvOiBKb2kuYW55KClcbn0pO1xuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVBc3NldChvYmo6IGFueSk6IHtcbiAgICBlcnJvcjogYW55LFxuICAgIHZhbHVlOiBBc3NldFxufSB7XG4gICAgcmV0dXJuIGpvaUFzc2V0LnZhbGlkYXRlKG9iaik7XG59XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVBc3NldHNUYWJsZSA9IGF3YWl0IGZzcC5yZWFkRmlsZShcbiAgICAgICAgcGF0aC5qb2luKGltcG9ydC5tZXRhLmRpcm5hbWUsXG4gICAgICAgICAgICAnc3FsJywgJ2NyZWF0ZS10YWJsZS1hc3NldHMuc3FsJyksXG4gICAgICAgICd1dGYtOCdcbik7XG5cbi8vIFRoaXMgZnVuY3Rpb24gYW5kIGl0cyBzaWJsaW5ncyBleGlzdCB0byBhdm9pZFxuLy8gcG90ZW50aWFsIGZvciBjb25mbGljdCBpbiBpbml0aWFsaXppbmcgdGhlXG4vLyB2YXJpYWJsZSBob2xkaW5nIHRoZSBTUUwgYW5kIGludm9raW5nXG4vLyB0aGUgU1FMIHRvIGNyZWF0ZSB0aGUgdGFibGUuICBCeSBwbGFjaW5nIGJvdGhcbi8vIGluIHRoZSBzYW1lIHNvdXJjZSBmaWxlIHdlIGVuc3VyZSBubyBjb25mbGljdC5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkb0NyZWF0ZUFzc2V0c1RhYmxlKFxuICAgIGRiOiBBc3luY0RhdGFiYXNlXG4pIHtcbiAgICBhd2FpdCBkYi5ydW4oYXdhaXQgY3JlYXRlQXNzZXRzVGFibGUpO1xufVxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLyBQYXJ0aWFsXG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFydGlhbEZpZWxkcyB7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgY29udGVudCBmb3IgdGhlIHRlbXBsYXRlLlxuICAgICAqL1xuICAgIGRvY0JvZHk6IHN0cmluZztcblxuICAgIC8qKlxuICAgICAqIFRoZSBuYW1lIG9mIHRoZSBSZW5kZXJlciBjbGFzcy5cbiAgICAgKiBcbiAgICAgKiA/Pz8gVE9ETyBJUyBUSElTIE5FRURFRFxuICAgICAqL1xuICAgIHJlbmRlcmVyTmFtZTogc3RyaW5nO1xufTtcblxuZXhwb3J0IHR5cGUgUGFydGlhbCA9IEJhc2VDYWNoZUVudHJ5ICYgUGFydGlhbEZpZWxkcztcblxuZXhwb3J0IGNvbnN0IGpvaVBhcnRpYWwgPSBKb2kub2JqZWN0KHtcbiAgICB2cGF0aDogSm9pLnN0cmluZygpLFxuICAgIHJlbmRlclBhdGg6IEpvaS5zdHJpbmcoKSxcbiAgICBtaW1lOiBKb2kuc3RyaW5nKCkub3B0aW9uYWwoKS5hbGxvdyhudWxsKSxcbiAgICBtb3VudGVkOiBKb2kuc3RyaW5nKCksXG4gICAgbW91bnRQb2ludDogSm9pLnN0cmluZygpLFxuICAgIHBhdGhJbk1vdW50ZWQ6IEpvaS5zdHJpbmcoKSxcbiAgICBmc3BhdGg6IEpvaS5zdHJpbmcoKSxcbiAgICBkaXJuYW1lOiBKb2kuc3RyaW5nKCksXG4gICAgbXRpbWVNczogSm9pLm51bWJlcigpLCAvLyAuaW50ZWdlcigpLFxuICAgIGluZm86IEpvaS5hbnkoKSxcblxuICAgIC8vIEFkZGVkIGZpZWxkc1xuICAgIGRvY0JvZHk6IEpvaS5zdHJpbmcoKS5vcHRpb25hbCgpLmFsbG93KG51bGwpLFxuICAgIHJlbmRlcmVyTmFtZTogSm9pLnN0cmluZygpLm9wdGlvbmFsKCkuYWxsb3cobnVsbClcblxufSk7XG5cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVBhcnRpYWwob2JqOiBhbnkpOiB7XG4gICAgZXJyb3I6IGFueSxcbiAgICB2YWx1ZTogUGFydGlhbFxufSB7XG4gICAgcmV0dXJuIGpvaVBhcnRpYWwudmFsaWRhdGUob2JqKTtcbn1cblxuZXhwb3J0IGNvbnN0IGNyZWF0ZVBhcnRpYWxzVGFibGUgPSBhd2FpdCBmc3AucmVhZEZpbGUoXG4gICAgICAgIHBhdGguam9pbihpbXBvcnQubWV0YS5kaXJuYW1lLFxuICAgICAgICAgICAgJ3NxbCcsICdjcmVhdGUtdGFibGUtcGFydGlhbHMuc3FsJyksXG4gICAgICAgICd1dGYtOCdcbik7XG5cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRvQ3JlYXRlUGFydGlhbHNUYWJsZShcbiAgICBkYjogQXN5bmNEYXRhYmFzZVxuKSB7XG4gICAgYXdhaXQgZGIucnVuKGF3YWl0IGNyZWF0ZVBhcnRpYWxzVGFibGUpO1xufVxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLyBMYXlvdXRcblxuZXhwb3J0IGludGVyZmFjZSBMYXlvdXRGaWVsZHMge1xuXG4gICAgLyoqXG4gICAgICogV2hldGhlciB0aGlzIHRlbXBsYXRlIHByb2R1Y2VzXG4gICAgICogSFRNTC5cbiAgICAgKiBcbiAgICAgKiA/Pz8gSVMgVEhJUyBORUVERUQ/XG4gICAgICovXG4gICAgcmVuZGVyc1RvSFRNTDogYm9vbGVhbjtcblxuICAgIC8qKlxuICAgICAqIFRoZSBjb250ZW50IGZvciB0aGUgdGVtcGxhdGUuXG4gICAgICovXG4gICAgZG9jQm9keTogc3RyaW5nO1xuXG4gICAgLyoqXG4gICAgICogVGhlIG5hbWUgb2YgdGhlIFJlbmRlcmVyIGNsYXNzLlxuICAgICAqIFxuICAgICAqID8/PyBUT0RPIElTIFRISVMgTkVFREVEXG4gICAgICovXG4gICAgcmVuZGVyZXJOYW1lOiBzdHJpbmc7XG59O1xuXG5leHBvcnQgdHlwZSBMYXlvdXQgPSBCYXNlQ2FjaGVFbnRyeSAmIExheW91dEZpZWxkcztcblxuZXhwb3J0IGNvbnN0IGpvaUxheW91dCA9IEpvaS5vYmplY3Qoe1xuXG4gICAgdnBhdGg6IEpvaS5zdHJpbmcoKSxcbiAgICByZW5kZXJQYXRoOiBKb2kuc3RyaW5nKCksXG4gICAgbWltZTogSm9pLnN0cmluZygpLm9wdGlvbmFsKCkuYWxsb3cobnVsbCksXG4gICAgbW91bnRlZDogSm9pLnN0cmluZygpLFxuICAgIG1vdW50UG9pbnQ6IEpvaS5zdHJpbmcoKSxcbiAgICBwYXRoSW5Nb3VudGVkOiBKb2kuc3RyaW5nKCksXG4gICAgZnNwYXRoOiBKb2kuc3RyaW5nKCksXG4gICAgZGlybmFtZTogSm9pLnN0cmluZygpLFxuICAgIG10aW1lTXM6IEpvaS5udW1iZXIoKSwgLy8gLmludGVnZXIoKSxcbiAgICBpbmZvOiBKb2kuYW55KCksXG5cbiAgICAvLyBBZGRlZCBmaWVsZHNcbiAgICByZW5kZXJzVG9IVE1MOiBKb2kuYWx0ZXJuYXRpdmVzKClcbiAgICAgICAgLnRyeShcbiAgICAgICAgICAgIEpvaS5ib29sZWFuKCksXG4gICAgICAgICAgICBKb2kubnVtYmVyKCkuaW50ZWdlcigpLm1pbigwKS5tYXgoMSlcbiAgICAgICAgKSxcbiAgICBkb2NCb2R5OiBKb2kuc3RyaW5nKCkub3B0aW9uYWwoKS5hbGxvdyhudWxsKSxcbiAgICByZW5kZXJlck5hbWU6IEpvaS5zdHJpbmcoKS5taW4oMCkub3B0aW9uYWwoKS5hbGxvdyhudWxsKVxuXG59KTtcblxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlTGF5b3V0KG9iajogYW55KToge1xuICAgIGVycm9yOiBhbnksXG4gICAgdmFsdWU6IExheW91dFxufSB7XG4gICAgcmV0dXJuIGpvaUxheW91dC52YWxpZGF0ZShvYmopO1xufVxuXG5leHBvcnQgY29uc3QgY3JlYXRlTGF5b3V0c1RhYmxlID0gYXdhaXQgZnNwLnJlYWRGaWxlKFxuICAgICAgICBwYXRoLmpvaW4oaW1wb3J0Lm1ldGEuZGlybmFtZSxcbiAgICAgICAgICAgICdzcWwnLCAnY3JlYXRlLXRhYmxlLWxheW91dHMuc3FsJyksXG4gICAgICAgICd1dGYtOCdcbik7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkb0NyZWF0ZUxheW91dHNUYWJsZShcbiAgICBkYjogQXN5bmNEYXRhYmFzZVxuKSB7XG4gICAgYXdhaXQgZGIucnVuKGF3YWl0IGNyZWF0ZUxheW91dHNUYWJsZSk7XG59XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vIERvY3VtZW50XG5cbmV4cG9ydCBpbnRlcmZhY2UgRG9jdW1lbnRGaWVsZHMge1xuXG4gICAgLyoqXG4gICAgICogVGhlIHZpcnR1YWwgcGF0aG5hbWUgdG8gd2hpY2ggdGhpc1xuICAgICAqIGRvY3VtZW50IHJlbmRlcnMgaW4gdGhlIG91dHB1dCBkaXJlY3RvcnkuXG4gICAgICovXG4gICAgcmVuZGVyUGF0aDogc3RyaW5nO1xuXG4gICAgLyoqXG4gICAgICogV2hldGhlciB0aGlzIHRlbXBsYXRlIHByb2R1Y2VzXG4gICAgICogSFRNTC5cbiAgICAgKiBcbiAgICAgKiA/Pz8gSVMgVEhJUyBORUVERUQ/XG4gICAgICovXG4gICAgcmVuZGVyc1RvSFRNTDogYm9vbGVhbjtcblxuICAgIC8qKlxuICAgICAqIFRoZSB2aXJ0dWFsIHBhdGhuYW1lIHRoYXQgaXMgdGhlXG4gICAgICogZGlyZWN0b3J5IG5hbWUgb2YgdGhlIHJlbmRlclBhdGguXG4gICAgICovXG4gICAgLy8gSU4gQkFTRSBDQUNIRSBkaXJuYW1lOiBzdHJpbmc7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgdmlydHVhbCBwYXRobmFtZSB0aGF0IGlzIHRoZVxuICAgICAqIHBhcmVudCBkaXJlY3RvcnkgbmFtZSBvZiBkaXJuYW1lLlxuICAgICAqIFxuICAgICAqID8/Pz8/IElTIFRISVMgTkVFREVEXG4gICAgICovXG4gICAgcGFyZW50RGlyOiBzdHJpbmc7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgXCJ0aW1lXCIgKHNlY29uZHMgc2luY2UgSmFuIDEgMTk3MClcbiAgICAgKiBjb3JyZXNwb25kaW5nIHRvIHRoZSBwdWJsaWNhdGlvbkRhdGVcbiAgICAgKiBmaWVsZCBpbiB0aGUgZG9jdW1lbnQgbWV0YWRhdGEuXG4gICAgICogXG4gICAgICogSU5URUdFUiBHRU5FUkFURUQgQUxXQVlTXG4gICAgICogIEFTIChqc29uX2V4dHJhY3QoaW5mbywgJyQucHVibGljYXRpb25UaW1lJykpIFNUT1JFRFxuICAgICAqL1xuICAgIHB1YmxpY2F0aW9uVGltZTogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogVGhlIHZhbHVlIGZvciB0aGUgYmFzZU1ldGFkYXRhIG9mXG4gICAgICogdGhlIG1vdW50ZWQgdmlydHVhbCBkaXJlY3RvcnkgaW5cbiAgICAgKiB3aGljaCB0aGlzIGZpbGUgaXMgc3RvcmVkLiAgVGhpc1xuICAgICAqIG1ldGFkYXRhIGlzIHVzZWQgaW4gY29tcHV0aW5nIHRoZVxuICAgICAqIGZpbmFsIG1ldGFkYXRhLlxuICAgICAqIFxuICAgICAqIFRFWFQgR0VORVJBVEVEIEFMV0FZU1xuICAgICAqICBBUyAoanNvbl9leHRyYWN0KGluZm8sICckLmJhc2VNZXRhZGF0YScpKSBTVE9SRURcbiAgICAgKi9cbiAgICBiYXNlTWV0YWRhdGE6IGFueTtcblxuICAgIC8qKlxuICAgICAqIFRoZSB2YWx1ZSBmb3IgdGhlIGhlYWRlciBtZXRhZGF0YSBvZlxuICAgICAqIHRoZSBkb2N1bWVudC4gIFRoaXMgbWV0YWRhdGEgaXMgdXNlZCxcbiAgICAgKiBhbG9uZyB3aXRoIGRvY01ldGFkYXRhLCBpbiBjb21wdXRpbmcgdGhlXG4gICAgICogZmluYWwgbWV0YWRhdGEuXG4gICAgICovXG4gICAgZG9jTWV0YWRhdGE6IGFueTtcblxuICAgIC8qKlxuICAgICAqIFRoZSBjb250ZW50IGZvciB0aGUgZG9jdW1lbnQuXG4gICAgICovXG4gICAgZG9jQ29udGVudDogc3RyaW5nO1xuXG4gICAgLyoqXG4gICAgICogVGhlIGJvZHkgcG9ydGlvbiBvZiB0aGUgZG9jdW1lbnQuXG4gICAgICovXG4gICAgZG9jQm9keTogc3RyaW5nO1xuXG4gICAgLyoqXG4gICAgICogVGhlIGZpbmFsIG1ldGFkYXRhIGZvciB0aGUgZG9jdW1lbnQsXG4gICAgICogd2hpY2ggaXMgY29tcHV0ZWQgZnJvbSBiYXNlTWV0YWRhdGFcbiAgICAgKiBhbmQgZG9jTWV0YWRhdGEuXG4gICAgICogXG4gICAgICogVEVYVCBHRU5FUkFURUQgQUxXQVlTXG4gICAgICogIEFTIChqc29uX2V4dHJhY3QoaW5mbywgJyQubWV0YWRhdGEnKSkgU1RPUkVEXG4gICAgICovXG4gICAgbWV0YWRhdGE6IGFueTtcblxuICAgIC8qKlxuICAgICAqIFRoZSBhcnJheSBvZiB0YWcgc3RyaW5ncyBkZXJpdmVkIGZyb21cbiAgICAgKiB0aGUgdGFncyBmaWVsZCBvZiB0aGUgZG9jdW1lbnQgbWV0YWRhdGEuXG4gICAgICogXG4gICAgICogVEVYVCBHRU5FUkFURUQgQUxXQVlTXG4gICAgICogIEFTIChqc29uX2V4dHJhY3QoaW5mbywgJyQubWV0YWRhdGEudGFncycpKSBTVE9SRURcbiAgICAgKi9cbiAgICB0YWdzOiBhbnk7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgY29udGVudCBvZiB0aGUgbGF5b3V0IGZpZWxkXG4gICAgICogb2YgdGhlIGRvY3VtZW50IG1ldGFkYXRhLlxuICAgICAqIFxuICAgICAqIFRFWFQgR0VORVJBVEVEIEFMV0FZU1xuICAgICAqICBBUyAoanNvbl9leHRyYWN0KG1ldGFkYXRhLCAnJC5sYXlvdXQnKSkgU1RPUkVEXG4gICAgICovXG4gICAgbGF5b3V0OiBzdHJpbmc7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgY29udGVudCBvZiB0aGUgYmxvZ3RhZyBmaWVsZFxuICAgICAqIG9mIHRoZSBkb2N1bWVudCBtZXRhZGF0YS5cbiAgICAgKiBcbiAgICAgKiBURVhUIEdFTkVSQVRFRCBBTFdBWVNcbiAgICAgKiAgQVMgKGpzb25fZXh0cmFjdChtZXRhZGF0YSwgJyQuYmxvZ3RhZycpKSBTVE9SRURcbiAgICAgKi9cbiAgICBibG9ndGFnOiBzdHJpbmc7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgUmVuZGVyZXIgY2xhc3MuXG4gICAgICogXG4gICAgICogPz8/IFRPRE8gSVMgVEhJUyBORUVERURcbiAgICAgKi9cbiAgICByZW5kZXJlck5hbWU6IHN0cmluZztcbn07XG5cbmV4cG9ydCB0eXBlIERvY3VtZW50ID0gQmFzZUNhY2hlRW50cnlcbiAgICAgICAgICAgICAgICAgICAgICYgRG9jdW1lbnRGaWVsZHM7XG5cbmV4cG9ydCBjb25zdCBqb2lEb2N1bWVudCA9IEpvaS5vYmplY3Qoe1xuXG4gICAgdnBhdGg6IEpvaS5zdHJpbmcoKSxcbiAgICBtaW1lOiBKb2kuc3RyaW5nKCkub3B0aW9uYWwoKS5hbGxvdyhudWxsKSxcbiAgICBtb3VudGVkOiBKb2kuc3RyaW5nKCksXG4gICAgbW91bnRQb2ludDogSm9pLnN0cmluZygpLFxuICAgIHBhdGhJbk1vdW50ZWQ6IEpvaS5zdHJpbmcoKSxcbiAgICBmc3BhdGg6IEpvaS5zdHJpbmcoKSxcbiAgICBkaXJuYW1lOiBKb2kuc3RyaW5nKCksXG4gICAgbXRpbWVNczogSm9pLm51bWJlcigpLCAvLyAuaW50ZWdlcigpLFxuICAgIGluZm86IEpvaS5hbnkoKSxcblxuICAgIC8vIEFkZGVkIGZpZWxkc1xuICAgIHJlbmRlclBhdGg6IEpvaS5zdHJpbmcoKSxcbiAgICByZW5kZXJzVG9IVE1MOiBKb2kuYWx0ZXJuYXRpdmVzKClcbiAgICAgICAgLnRyeShcbiAgICAgICAgICAgIEpvaS5ib29sZWFuKCksXG4gICAgICAgICAgICBKb2kubnVtYmVyKCkuaW50ZWdlcigpLm1pbigwKS5tYXgoMSlcbiAgICAgICAgKSxcbiAgICBwYXJlbnREaXI6IEpvaS5zdHJpbmcoKSxcbiAgICBwdWJsaWNhdGlvblRpbWU6IEpvaS5udW1iZXIoKS5vcHRpb25hbCgpLmFsbG93KG51bGwpLFxuICAgIGJhc2VNZXRhZGF0YTogSm9pLmFueSgpLFxuICAgIGRvY01ldGFkYXRhOiBKb2kuYW55KCksXG4gICAgZG9jQ29udGVudDogSm9pLnN0cmluZygpLm1pbigwKS5vcHRpb25hbCgpLmFsbG93KG51bGwpLFxuICAgIGRvY0JvZHk6IEpvaS5zdHJpbmcoKS5taW4oMCkub3B0aW9uYWwoKS5hbGxvdyhudWxsKSxcbiAgICBtZXRhZGF0YTogSm9pLmFueSgpLFxuICAgIHRhZ3M6IEpvaS5hbnkoKSxcbiAgICBsYXlvdXQ6IEpvaS5hbHRlcm5hdGl2ZXMoKVxuICAgICAgICAudHJ5KFxuICAgICAgICAgICAgSm9pLnN0cmluZygpLFxuICAgICAgICAgICAgSm9pLmFsbG93KG51bGwpXG4gICAgICAgICksXG4gICAgYmxvZ3RhZzogSm9pLmFsdGVybmF0aXZlcygpXG4gICAgICAgIC50cnkoXG4gICAgICAgICAgICBKb2kuc3RyaW5nKCksXG4gICAgICAgICAgICBKb2kuYWxsb3cobnVsbClcbiAgICAgICAgKSxcbiAgICByZW5kZXJlck5hbWU6IEpvaS5zdHJpbmcoKS5taW4oMCkub3B0aW9uYWwoKS5hbGxvdyhudWxsKVxuXG59KTtcblxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlRG9jdW1lbnQob2JqOiBhbnkpOiB7XG4gICAgZXJyb3I6IGFueSxcbiAgICB2YWx1ZTogRG9jdW1lbnRcbn0ge1xuICAgIHJldHVybiBqb2lEb2N1bWVudC52YWxpZGF0ZShvYmopO1xufVxuXG5leHBvcnQgY29uc3QgY3JlYXRlRG9jdW1lbnRzVGFibGUgPSBhd2FpdCBmc3AucmVhZEZpbGUoXG4gICAgICAgIHBhdGguam9pbihpbXBvcnQubWV0YS5kaXJuYW1lLFxuICAgICAgICAgICAgJ3NxbCcsICdjcmVhdGUtdGFibGUtZG9jdW1lbnRzLnNxbCcpLFxuICAgICAgICAndXRmLTgnXG4pO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZG9DcmVhdGVEb2N1bWVudHNUYWJsZShcbiAgICBkYjogQXN5bmNEYXRhYmFzZVxuKSB7XG4gICAgYXdhaXQgZGIucnVuKGF3YWl0IGNyZWF0ZURvY3VtZW50c1RhYmxlKTtcbn0iXX0=